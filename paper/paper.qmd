---
title: "Analyzing the Effects of Climatic Change on Rice Production Yields in Asia Major Agricultural Regions"
author: 
  - Yang Cheng 
  
thanks: "Code and data are available at: https://github.com/E1cheng/Aisa_Climate_Change.
A replication of various aspects in this paper are available at: https://www.socialsciencereproduction.org/reproductions/1807/index?step=0"
date: today
date-format: long
abstract: "In this study, we investigate the repercussions of climatic alterations on rice production yields across Asia's principal agricultural regions over the decade spanning 2011 to 2020. The modeling results indicate the intricate relationship between climatic variables and rice yield fluctuations. The findings underscore significant regional disparities in rice production outcomes, attributable to the differential impacts of climate change. This research contributes to the broader understanding of the challenges and opportunities facing rice production in the context of climatic variability, offering crucial insights for the development of adaptive strategies to ensure food security in the face of environmental change."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(ggplot2)
library(dplyr)
library(arrow)
library(here)
library(kableExtra)
library(knitr)
library(sf)
library(maps)
library(tidybayes)
library(modelsummary)
```

# Introduction {#sec-intro}

The advent of climate change, recognized as one of the pivotal environmental challenges of the 21st century, has incited extensive investigation into its pervasive effects on ecosystems, human health, and, critically, global agricultural productivity. Despite the breadth of research, the nuanced impacts of this phenomenon on rice production yields within Asia's major agricultural regions remain insufficiently explored. Rice, being a staple food for a significant portion of the global population, particularly in Asia, stands at the forefront of this inquiry.

This study replicates and extends the groundbreaking research the 2022 article ‘A global dataset for the projected impacts of climate change on four major crops’ [@citeHasegawa2022], which meticulously constructed a comprehensive global dataset by amalgamating scientific databases, journal articles, and institutional website data. Their work, spanning from 1990 to 2020, laid the foundational groundwork for assessing the projected impacts of climate change on the yields of four major crops across various geographic regions, intertwined with local climatic conditions. By consolidating a vast array of previously isolated data points into a unified dataset, their study provides an invaluable resource for understanding the complex dynamics between crop yields and climate change.

In this exploration, our focus is on building upon this dataset to ascertain the direct causal impact of climatic changes on rice yields in Asia within the 2011-2020 timeframe. This is quantified through the variation in production outcomes directly attributable to climatic aberrations. Our analysis uncovers a notable variance in rice production outcomes directly correlatable to the interplay of climatic changes, including alterations in precipitation patterns, temperature variations, and CO2 concentration levels. Through this lens, we aim to provide a granular understanding of how environmental shifts precipitate significant outcomes in agricultural domains, thereby offering insights crucial for developing resilient food systems in the face of ongoing climatic uncertainties.

The paper is structured to facilitate a comprehensive understanding of the study and its implications. Following @sec-intro, @sec-data presents the data, detailing the data sources, analytical techniques, and the rationale behind the chosen methods. @sec-result discusses the results. @sec-discussion provides an in-depth discussion of these findings.

# Data {#sec-data}

This section is dedicated to elucidating the dataset employed in our inquiry, which critically examines agricultural trends within major Asian countries. We have curated data from an array of randomly selected significant nations in Asia, concentrating on key climatic and production variables. Our dataset encompasses entries that span a decade, from 2011 to 2020, detailing essential factors such as temperature change, precipitation variation, projected yield, and CO2 concentrations. By leveraging these data, our study endeavors to unravel the intricate tapestry of how climatic factors interweave with agricultural productivity across diverse Asian agronomic landscapes.

## Source and Methodology

The dataset used in this study originates from the paper by [@citeHasegawa2022], titled "A global dataset for the projected impacts of climate change on four major crops". This comprehensive dataset is pivotal for understanding the projected impacts of climate change on crop yields.

The data encompasses projections of yield changes due to climate change for maize, rice, soybean, and wheat across 91 countries. The dataset is a culmination of 8703 simulations from 202 studies conducted between 1984 and 2020, meticulously compiled through a systematic review of scientific databases, journal articles, and institutional website data, including Scopus, Web of Science, and others. Additionally, geographical coordinates along with current and projected temperature and precipitation levels are integrated, providing a robust framework for quantitative assessments of climate impact on crop production.

This dataset, prepared for the IPCC Working Group II assessment, was initially formed by combining the meta-analysis dataset used by [@citeAggarwal2019], which covered studies from the first five IPCC assessment cycles, and extended with new literature searches for the sixth IPCC assessment cycle (2014–2020), thereby capturing the most relevant variables to evaluate the climate change impacts on crop yields. Efforts were made to ensure data quality and reliability through extensive cross-checks with original sources, recalculations of yields, and adjustments based on new climate scenario data. The resultant dataset stands as an open resource for subsequent analyses, driving forward the data-driven machine learning applications in the agricultural sector.

The dataset underwent rigorous validation processes, including cross-checks with original sources, recalculations of some projected yields, and adjustments based on new climate scenario data. This ensured the accuracy and reliability of the dataset for further analyses. This data was downloaded, cleaned, parsed, analyzed, and visualized using R [@citeR], a statistical programming language, with package support from `tidyverse` [@citetidyverse], a collection of libraries which included the following packages that were utilized:

-   `ggplot2` [@citeggplot]
-   `dplyr` [@citedplyr]
-   `kableExtra` [@citekableExtra]
For additional assistance with data storage, the `arrow` [@citearrow] was used and for report generation, the `knitr` [@citeknitr] package was used.

## Variables

To determine the impact of various climate change factors on rice production in Asia, we compiled a summary table that systematically details each variable, explaining their relevance and effects on regional rice yields.

```{r}
#| label: tbl-agriculture-info
#| tbl-cap: First Ten Rows of Agriculture Data
#| echo: false
#| warning: false
#| message: false

# Specify the file path and read the data
agriculture_data <- read_parquet(here::here("data/analysis_data/agriculture.parquet"))

# Select specific columns and slice the first 10 rows
agriculture_data |>
  select(country, local_delta_t, annual_precipitation_change_each_study_mm, co2_ppm, climate_impacts_per_decade_percent) |> 
  slice(1:10) |>
  kable(
    col.names = c("Country", "Temperature Change", "Precipitation Change", "CO2 Concentrations", "Climate Impacts"), 
    booktabs = TRUE
  )
```

@tbl-agriculture-info, encapsulate each variable, articulating both its direct correlation with rice yields and the broader implications for the region’s agricultural output. 

For the geographical specificity, "Country" delineates the area under study, recognizing the diversity within Asia's vast agricultural landscapes and enabling an assessment that is both nuanced and regionally contextualized. 

"Temperature Change" denotes the local temperature change, a crucial variable considering rice’s sensitivity to thermal conditions. This metric aids in understanding the stress imposed by local temperature fluctuations on crop development and yield. 

"Precipitation Change" measures the deviations in annual precipitation from a given baseline, serving as a critical indicator of water resource availability, which is paramount to rice cultivation—a crop significantly dependent on consistent water supply. 

"CO2 Concentrations" indicates the levels of atmospheric carbon dioxide, a variable of dual significance: its role in directly influencing plant photosynthetic activity and its broader part in the spectrum of climate change parameters impacting agricultural productivity.

"Climate Impacts" gauges the decadal percentage change in rice yields as a result of climate influences, indicating the pace at which climate variables are reshaping agricultural productivity over time.

## Data Visualization

@fig-pc, presents a scatter plot that illustrates the relationship between annual precipitation change and its impact on climate, as quantified by changes in crop yields per decade. The data points densely populate around the zero line of climate impact, suggesting that there is a considerable concentration of observations where changes in precipitation have a neutral effect on crop yields. However, there are noticeable trends on either side of the central cluster. On one side, there is a subtle indication that a moderate increase in precipitation could correlate with increased yields, pointing towards the benefit of additional water resources for the crop within a specific threshold. On the contrary, the data significantly deviates below the zero line when precipitation change is negative and substantial, illustrating a steep decline in yields. This sharp downturn reflects the vulnerability of rice production to drought conditions, where a significant deficit in rainfall can severely hamper crop productivity.

```{r}
#| label: fig-pc
#| fig-cap: Annual Precipitation change vs Climate Impact
#| echo: false

agriculture <- read_parquet(here::here("data/analysis_data/agriculture.parquet"))

ggplot(agriculture, aes(x = reorder(annual_precipitation_change_each_study_mm, climate_impacts_per_decade_percent), 
                             y = climate_impacts_per_decade_percent)) +
  geom_point() +
  labs(x = "Annual Precipitation Change (mm)", 
       y = "Climate Impacts Per Decade (%)", 
       title = "Relationship between Annual Precipitation Change and Climate Impact per Decade") +
  theme_minimal()
```

```{r}
#| label: fig-tc
#| fig-cap: Temperature vs Climate Impact
#| echo: false

agriculture <- read_parquet(here::here("data/analysis_data/agriculture.parquet"))

ggplot(agriculture, aes(x = climate_impacts_per_decade_percent, y = local_delta_t)) +
  geom_point() +
  ggtitle("Temperature vs Climate Impact") +
  labs(x = "Climate Impacts Per Decade (%)",
       y =   "Local Delta T (°C)") +
  theme_minimal()

```

@fig-tc, displays the relationship between local temperature changes (Local Delta T) and their corresponding climate impacts per decade on crop yields. The scatter plot indicates a denser congregation of data points at the lower end of temperature changes, suggesting that smaller increases in local temperature do not have a significant impact on yields. However, as the Local Delta T rises above 2°C, there's an observable spread in climate impacts, both positive and negative, though with a tendency towards more negative impacts as temperature deviations increase. This could suggest that moderate temperature increases may be beneficial to a point, possibly due to a lengthened growing season or enhanced photosynthetic efficiency, but beyond a certain threshold, the negative effects such as heat stress and increased evapotranspiration outweigh any benefits, leading to reduced crop productivity.

```{r}
#| label: fig-cc
#| fig-cap: CO2 vs Climate Impact
#| echo: false

agriculture <- read_parquet(here::here("data/analysis_data/agriculture.parquet"))

ggplot(agriculture, aes(x = co2_ppm, y =climate_impacts_per_decade_percent)) +
  geom_point() +
  ggtitle("CO2 vs Climate Impact") +
  labs(x = "Climate Impacts Per Decade (%)",
       y =   "CO2 (ppm)") +
  theme_minimal()

```

@fig-cc , presents the correlation between CO2 levels and climate impacts per decade on crop yields. The plot reveals that across a spectrum of CO2 concentration changes, the impact on climate varies, with a cluster of outcomes showing no significant relationship between increased CO2 levels and yield. Despite higher CO2 levels often associated with enhanced photosynthesis and plant growth, the data indicates that these potential benefits do not uniformly translate to increased yields.

# Model {#sec-model}

Gaussian regression is a regression model where the dependent variable is assumed to have a Normal distribution. In Gaussian regression, the errors are assumed to be normally distributed, and models the mean of the distribution as a linear function of the predictors. The Gaussian regression is useful for continuous response variable that displays normality.

In our context, we will fit our data with the Gaussian regression to discover relation between crop yield and various independent variables such as annual precipitation and temperature.

### Model Setup

Let $y$ be the dependent variable `climate_impacts_per_decade_percent`, which is a percentage of crop yields.


$$
\begin{aligned}

y_i &\sim \mathcal{N}(\mu_i, \sigma^2) \\ 
\mu_i &= \beta_0 + \beta_1 \times \text{local temperature change}_i + \beta_2 \times \text{annual precipitation change}_i + \beta_3 \times \text{co2}_i \\
\beta_j &\sim \mathcal{N}(0, 2.5^2) \space \text{for j = 1, 2, 3} \\
\sigma &\sim \text{Exponential}(1)

\end{aligned}
$$

- $\beta_0$ is the intercept,
- $\beta_1$ is the coefficient for the predictor `local_delta_t`,
- $\beta_2$ is the coefficient for the predictor `annual_precipitation_change_each_study_mm`,
- $\beta_3$ is the coefficient for the predictor `co2_ppm`.

We will run the model in R [@citeR] using the `rstanarm` package of [@citerstanarm].


### Model Justification
The purpose of this model is to discover an understanding of the factors affecting crop yields as influenced by climate, with an expectation of linear effects and normally distributed outcomes.The use of Gaussian regression is justified from previous visualizations, as the changes in the predictor variables are proportional to the expected value of the outcome. Moreover, the Gaussian family is intuitive for modeling continuous outcomes like percentages, which is the outcome we are attempted to learn of.

# Results {#sec-result}

This section elucidates the principal findings concerning the interplay between climatic variables and rice yield across Asia's key agricultural zones. It particularly sheds light on how temperature fluctuations, precipitation changes, and carbon dioxide levels are interwoven with the intricacies of rice production. By delving into the effects of these environmental factors, we aim to unravel the complexity of their collective influence on agricultural output, providing a nuanced understanding of how regional climate conditions drive variations in crop yields.

## Model Visualization

```{r}
#| label: tbl-ms
#| tbl-cap: Summary of Gaussian Model
#| echo: false
#| warning: false


model <- read_rds(here::here("models/gaussian.rds"))

modelsummary(
  list(
    "Gaussian" = model
  )
)

```
@tbl-ms, we see that the intercept is significantly negative, which could be indicative of an overall negative trend in the absence of other factors. The coefficients for local temperature change (local_delta_t) and CO2 concentration (co2_ppm) are positive, suggesting that, in isolation, increases in temperature and CO2 might be associated with increases in rice yield, possibly due to the fertilization effect of CO2 and the extended growing seasons from warmer temperatures. However, the negative coefficient for annual precipitation change (annual_precipitation_change_each_study_mm) highlights the critical role water availability plays in crop yields, where less rainfall is detrimental. The model's explanatory power, as shown by the R-squared value, suggests that while the model captures some of the variability in the data, much remains unexplained, which is not uncommon in complex systems like agriculture where numerous unmeasured factors could influence the outcome.

```{r}
#| label: fig-mg
#| fig-cap: Model Graph
#| echo: false


model <- read_rds(here::here("models/gaussian.rds"))

model |>
  spread_draws(`(Intercept)`, local_delta_t, annual_precipitation_change_each_study_mm, co2_ppm) |>
  mutate(condition_mean = `(Intercept)` + local_delta_t + annual_precipitation_change_each_study_mm + co2_ppm) |>
  ggplot(aes(x = condition_mean)) +
  stat_halfeye() +
  labs(x = "Conditional Mean",
       y = "Density", 
       title = "Distribution of Gaussian Model Predictions")+
  theme(panel.background = element_rect(fill = "white"),
        panel.grid.major = element_line(colour = "grey"),
        plot.title = element_text(color = "black", size = 14, face = "bold"),
        axis.title = element_text(color = "black"),
        axis.text.y = element_text(size = 5),
        legend.text = element_text(size = 7),
        plot.caption = element_text(hjust = 0.5) +
          coord_fixed(ratio = 0.7) )

```

Turning to @fig-mg, provide us with a profound insight into the dynamics of climate impact on rice production. The "Distribution of Gaussian Model Predictions" visualizes the spread of the model's conditional means, which represent the predicted climate impacts on rice production. This density plot shows a bell-shaped curve centered around a negative value, indicating that, on average, there's a tendency for a negative climate impact on rice yields within the dataset's scope.

The trend analysis, as observed in the distribution, suggests that while there is a variation in the model predictions with some positive impacts, the majority of the data points skew towards negative impacts. This implies that the climatic variables included in the model are, more often than not, associated with a decrease in rice production per decade. The spread of the distribution also hints at the variability of the impacts, with some regions potentially experiencing more severe effects of climate change than others.

These insights underscore the complex interplay between various climatic factors and their combined effect on agricultural productivity. While the model captures the general trend, it also prompts a deeper investigation into the nuanced and multifaceted nature of climate impacts on agriculture, beyond what is represented by the data at hand.

## Change in Rice Yield by Region

```{r}
#| label: fig-region
#| fig-cap: Regional Visualization of Production
#| echo: false

production_asia <- read_parquet(here::here("data/analysis_data/production.parquet"))


world_map <- map_data("world")


selected_countries <- c("japan", "thailand", "india", "bangladesh", "cambodia", 
                        "china", "indonesia", "iran", "korea", "laos", "myanmar", 
                        "nepal", "pakistan", "philippines", "sri lanka", "vietnam")

asia_map <- world_map |>
  filter(region %in% selected_countries)

asia_sf <- st_as_sf(map("world", regions = selected_countries, plot = FALSE, fill = TRUE))

median_production_sf <- production_asia |>
  mutate(country = recode(country, "Korea Rep" = "Korea")) |>
  inner_join(asia_sf, by = c("country" = "ID"))

ggplot(data = median_production_sf) +
  geom_sf(aes(fill = climate_impact_median, geometry = geom)) +
  scale_fill_viridis_c(name = "Median Production", option = "C", direction = -1) +
  theme_minimal() +
  labs(title = "Median Production by Country in Asia") +
  theme(legend.position = "bottom")
```
@fig-region, serves as a visual representation in our results section, showcasing the median rice production across different countries in Asia. The map delineates regions within Asia and uses a color gradient to signify the median production levels, with distinct hues corresponding to varying production volumes. The color scale reflects a range that includes both negative and positive production values, implying that certain regions may be experiencing declines in rice production.

The map reveals a heterogeneous pattern of median production values across Asia. Some areas display positive median production values, suggesting resilience or even growth in rice production, whereas other regions, particularly those represented in lighter shades, may be experiencing reductions. This geographic differentiation in production trends can be attributed to the similar climatic conditions and weather patterns shared by countries within the same region. For example, nations that share monsoonal patterns or similar temperature and precipitation regimes are likely to exhibit comparable agricultural outcomes due to these shared environmental influences.

# Discussion {#sec-discussion}

This research offers a vantage point on agricultural analysis, quantitatively elucidating the influence of climate variability on rice production across Asia. We have not only augmented these traditional methodologies but have also cast new light on the intricate nexus between environmental factors and agricultural productivity. Drawing upon a wealth of climatic data, this paper delves into the quantifiable effects that shifting weather patterns, temperature fluctuations, and atmospheric CO2 levels have on rice yields. We can begin to unravel the complex tapestry of factors shaping the future of food security in the face of global environmental changes.

##  Findings
In replicating the work of @citeHasegawa2022, our research confirms the finding: climate change exerts an influence on rice production yields in Asia's principal agricultural regions. While the impact of CO2, as illustrated by @fig-cc, appears relatively minor, this could be attributed to the regional variations in CO2 levels not being markedly pronounced or to the adaptive physiological responses of plants to inorganic substances. Both @fig-pc and @fig-tc underscore the correlation between temperature, precipitation, and production yield. The data visualization in @fig-mg further substantiates these findings, showcasing the density distribution of predicted climate impacts based on these variables.

##  Agricultural and Social Influence
In the agricultural domain, the implications of our study serve as a barometer for farming practices across diverse regions. Take, for instance, East Asian nations like China and Korea, where a marked increase in temperature has been observed in recent years. Farmers in these areas may consider reducing insulation measures or augmenting cooling systems to adapt to the warming climate. On the other hand, countries in South and Southeast Asia, such as India and the Philippines, have experienced a significant uptick in annual precipitation. While this could potentially enhance rice yields, the threat of flooding necessitates a strategic reduction in irrigation to mitigate the risk of crop loss due to water-related disasters.

Extending beyond the immediate agricultural impact, these climatic trends have broader socio-economic ramifications. For instance, alterations in crop yield can influence market prices and food security, affecting not just the agricultural sector but the entire economic fabric of these regions. Consequently, there is a cascading effect on the livelihoods of communities, where farmers may need to diversify crops or invest in new agricultural technologies.

Moreover, the findings underscore the urgency for infrastructural resilience. Governments and policymakers must invest in robust water management systems to harness the benefits of increased rainfall, while also bolstering defenses against extreme weather events. This dual approach can help safeguard the agricultural output, ensuring stability in both supply chains and local economies.

Lastly, the study highlights the critical need for climate education at the grassroots level. Providing farmers with the knowledge and resources to interpret and respond to climate data can empower them to make informed decisions, ultimately fostering a climate-resilient agricultural framework across Asia.

##  Weaknesses and Future Research Directions
Our study, while rigorous in its approach, is not without its limitations. The analysis predominantly hinges on climatic variables, potentially overlooking socio-economic factors, regional agricultural policies, and micro-environmental conditions that can also play significant roles in influencing rice yields. The Gaussian model, although robust, assumes normality and may not capture the full spectrum of uncertainties or non-linear relationships inherent in the data. Additionally, the cross-sectional nature of the study limits our ability to draw causal inferences or predict long-term trends.

Future research should aim to integrate a more comprehensive set of variables, including socio-economic factors, agricultural practices, and policy impacts, to construct a holistic view of the influences on rice production. Longitudinal studies could offer insights into the enduring effects of climate change and the effectiveness of adaptation strategies over time.

Embracing cutting-edge technologies such as remote sensing and machine learning could yield high-resolution data and more sophisticated predictive models. Such advancements would enable the identification of early-warning signals for adverse climatic events and the development of precision agriculture practices.

Moreover, there's a pronounced need for interdisciplinary collaboration, combining climate science with agronomy, economics, and social sciences. This multidisciplinary approach would contribute to more resilient and sustainable agricultural practices, tailored to the unique challenges of different regions.

In the realm of policy-making, our findings could guide the design of targeted interventions and the allocation of resources to the regions most in need. By understanding the specific vulnerabilities and capacities of each area, policies can be crafted to support adaptive measures that not only mitigate the impacts of climate change but also capitalize on potential benefits.

Ultimately, to address the global challenge posed by climate change to agriculture, our approach to research must be as dynamic and multifaceted as the issue itself. This calls for continuous monitoring, innovation, and adaptation in our research methods and models.

\newpage

# References
